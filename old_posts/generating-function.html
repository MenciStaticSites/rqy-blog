<!doctype html>
<html lang="zh-Hans-CN">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>生成函数简介 - 清芷的博客</title>
        <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon_3f3okc0t0smnz.png">
        <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32_lrgcr2u2dgnr.png">
        <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16_1siqrekx8ykol.png">
        <link rel="manifest" href="../site.webmanifest">
        <link rel="stylesheet" href="../css/fifthave_3dfyc7189qcwg.css" />
        <link rel="stylesheet" href="../css/syntax_lf612iqmmilx.css" />
        <link rel="stylesheet" href="../css/banana_2lzbro8offw8.css" />
        <link rel="stylesheet" href="../css/katex.min_1koofb1j5udh9.css" />
        <script src="../js/jquery-3.6.1.min_1udo1bomfn0oe.js"></script>
        <script src="../js/proof-collapse_rlvnn55bzvd0.js"></script>
        <script src="../js/table-of-contents_35en0xznwr03i.js"></script>
        
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>

        <!-- To automatically render math in text elements, include the auto-render extension: -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                renderMathInElement(document.body, {
                    // customised options
                    // ? auto-render specific keys, e.g.:
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false},
                        {left: '\\(', right: '\\)', display: false},
                        {left: '\\[', right: '\\]', display: true}
                    ],
                    // ? rendering keys, e.g.:
                    throwOnError : false
                });
            });
        </script>
        
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="..">清芷的博客</a>
            </div>
            <nav>
                <a href="..">首页</a>
                <a href="../about.html">关于</a>
                <a href="../contact.html">联系</a>
                <a href="../friends.html">友链</a>
                <a href="../archive.html">归档</a>
            </nav>
        </header>

        <main role="main">
            <h1>生成函数简介</h1>
            <div class="info">
    
    2018 年 06 月  4 日发布.
    
</div>

<h2 id="生成函数">生成函数</h2>
<p>生成函数(generating function)又称母函数，是处理组合数学问题的一大利器。</p>
<!--more-->
<h3 id="普通型生成函数">普通型生成函数</h3>
<h4 id="definition">Definition</h4>
<p>对于一个数列 $f=&lt;f_0,f_1,f_2\dots&gt;$ ，构造形式幂级数
$$
F(x) = \sum_{i=0}^{\infty}f_ix^i
$$
qi称为数列$f$的普通型生成函数（ordinary generating function, 下简称OGF）。</p>
<p>一些常见的OGF有：</p>
<table>
<thead>
<tr class="header">
<th>数列</th>
<th>OGF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>$&lt;1,0,0,\dots&gt;$</td>
<td>$1$</td>
</tr>
<tr class="even">
<td>$&lt;1,1,1,\dots&gt;$</td>
<td>$\frac1{1-x}$</td>
</tr>
<tr class="odd">
<td>$&lt;1,2,3,\dots&gt;$</td>
<td>$\frac1{(1-x)^2}$</td>
</tr>
<tr class="even">
<td>$&lt;1,-1,1,-1,\dots&gt;$</td>
<td>$\frac1{1+x}$</td>
</tr>
<tr class="odd">
<td>$&lt;1,2,1,0,0,\dots&gt;$</td>
<td>$(1+x)^2$</td>
</tr>
<tr class="even">
<td>$&lt;1,4,6,4,1,0,0,\dots&gt;$</td>
<td>$(1+x)^4$</td>
</tr>
</tbody>
</table>
<p>根据OGF的定义，容易发现OGF的运算和数列运算之间的关系：
$$
\begin{aligned}
\alpha F(x)+\beta G(x)&amp;=\sum_n(\alpha f_n+\beta g_n)x^n\\
x^mF(x)&amp;=\sum_n[n\geq m]f_{n-m}x^n\\
\frac{F(x)-\sum_{i=0}^{m-1}f_ix^i}{x^m}&amp;=\sum_nf_{n+m}x^n\\
F(cx)&amp;=\sum_nc^nf_nx^n\\
F^\prime(x)&amp;=\sum_n(n+1)f_{n+1}x^n\\
\int_0^xF(t)\mathrm{d}t&amp;=\sum_n[n&gt;0]\frac{f_{n-1}}nx^n\\
F(x)G(x)&amp;=\sum_n\left(\sum_{i=0}^nf_ig_{n-i}\right)x^n
\end{aligned}
$$
以上所有公式都是比较显然的，在此不证。</p>
<p>不过特别要注意最后一个式子，即OGF的乘积对应数列卷积。</p>
<p>通过上面的运算规则可以推出下面的式子。</p>
<table>
<thead>
<tr class="header">
<th>数列</th>
<th>OGF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>$&lt;1,c,c^2,c^3,\dots&gt;$</td>
<td>$\frac1{1-cx}$</td>
</tr>
<tr class="even">
<td>$&lt;1,n,\binom n2,\binom n3,\dots&gt;$</td>
<td>$(1+x)^n$</td>
</tr>
<tr class="odd">
<td>$&lt;1,n,\binom{n+1}2,\binom{n+1}3,\dots&gt;$</td>
<td>$(1-x)^{-n}$</td>
</tr>
<tr class="even">
<td>$&lt;0,1,\frac12,\frac13,\dots&gt;$</td>
<td>$\ln\frac1{1-x}$</td>
</tr>
<tr class="odd">
<td>$&lt;0,1,-\frac12,\frac13,-\frac14,\dots&gt;$</td>
<td>$\ln(1+x)$</td>
</tr>
<tr class="even">
<td>$&lt;1,1,\frac12,\frac16,\frac1{24},\dots&gt;$</td>
<td>$e^x$</td>
</tr>
</tbody>
</table>
<p>你会发现以上都是一些看上去很简单的东西。那么生成函数到底哪里厉害了呢？</p>
<h4 id="examples">Examples</h4>
<p>注：这里只是简介...所以并没有太多的例子...</p>
<h5 id="example-1">Example 1</h5>
<p>$$f_n=\begin{cases}n&amp;n\leqslant1\\f_{n-1}+f_{n-2}&amp;n&gt;1\end{cases}$$</p>
<p>简单的Fibonacci数列。</p>
<p>我们令 $F(x)$ 表示其OGF，则
$$
\begin{aligned}
F(x)&amp;=\sum_nf_nx^n\\
&amp;=\sum_n(f_n+f_{n-1}+[n=1])x^n\\
&amp;=F(x)+xF(x)+x
\end{aligned}
$$
从中我们解出$F(x)=\frac{x}{1-x-x^2}$。然而这有什么用呢？</p>
<p>我们令$\phi=\frac{1+\sqrt5}{2},\hat\phi=\frac{1-\sqrt5}2$，可以计算出$F(x)=\frac{1}{\sqrt5}\left(\frac1{1-\phi x}-\frac1{1-\hat\phi x}\right)$</p>
<p>根据$\frac1{1-cx}=\sum_nc^nx^n$，我们可以知道$f_n=\frac1{\sqrt5}\left(\phi^n-\hat\phi^n\right)$。就是这么简单。</p>
<h5 id="example-2">Example 2</h5>
<p><del>Warning!</del></p>
<p>许多线性递推的例子与上面的$F$相类似，于是我们直接来跳到一个复杂的例子来。</p>
<p>众所周知的Catalan数列的生成函数如何呢？</p>
<p>$$f_n=\begin{cases}1&amp;n=0\\\sum_{i=0}^{n-1}f_if_{n-i-1}&amp;n&gt;0\end{cases}$$</p>
<p>则
$$
\begin{aligned}
F(x)&amp;=\sum_n\left([n=0]+\sum_{i=0}^{n-1}f_if_{n-i-1}\right)x^n\\
&amp;=1+x\sum_n\left(\sum_{i=0}^{n-1}f_if_{n-1-i}\right)x^{n-1}\\
&amp;=1+xF^2(x)
\end{aligned}
$$
亦即$xF^2-F+1=0$。代入二次方程求根公式，我们可以得到$F(x)=\frac{1\pm\sqrt{1-4x}}{2x}$。</p>
<p>然而$\pm$取哪一个呢？我们发现一个数列$f$的生成函数$F$一定满足$F(0)=f_0$（某些情况下或许应该写成$\lim_{x\to0}F(x)=f_0$）。然而$f_0=1$，这意味着$F(0)=1$。而如果我们令$\pm$取$+$，那么$F(0)=\frac20$是未定义的，这显然不是一个多项式应有的表现。</p>
<p>于是我们得到：Catalan数的生成函数是$\frac{1-\sqrt{1-4x}}{2x}$。这个生成函数令人有点难以置信，我们可以尝试展开它<del>Warning!!!</del>。</p>
<p>展开它的方式是$(x+y)^c=\sum_i\binom cix^iy^{c-i}$在等式右端收敛（$\left|\frac xy\right|&lt;1\lor c\in \mathbb N$）的情况下成立。然而生成函数是<strong>形式</strong>幂级数，这意味着我们不需要考虑收敛性。</p>
<p>于是</p>
<p>$$
\sqrt{1-4x}=\sum_n\binom{\frac12}{n}(-4x)^n
$$</p>
<p>$$
\because\binom{\frac12}n=\frac{\frac12(\frac12-1)\dots(\frac12-n+1)}{n!}=\frac{(-1)^{n-1}1\times1\times3\times\dots\times(2n-3)}{2^nn!}=\frac{(-1)^{n-1}(2n-2)!}{2^{2n-1}n!(n-1)!}
$$</p>
<p>$$
\therefore\sqrt{1-4x}=\sum_n\binom{\frac12}{n}(-4x)^n=-2\sum_n\frac{(2n-2)!}{n!(n-1)!}x^n
$$</p>
<p>这意味着$$\frac{1-\sqrt{1-4x}}{2x}=\sum_n\frac{(2n)!}{n!(n+1)!}x^n$$，正是Catalan数的通项公式。</p>
<p>更多例子请见<a href="../tags/生成函数">生成函数</a>（可能有点困难...然而我的Blog里没几道简单题qaq...）。</p>
<p>或者<a href="https://en.wikipedia.org/wiki/Generating_function#Examples_of_generating_functions_for_simple_sequences">Wikipedia</a></p>
<h3 id="指数型生成函数">指数型生成函数</h3>
<h4 id="definition-1">Definition</h4>
<p>指数型生成函数（exponential generating function，简称EGF），其定义为</p>
<p>$$
F(x)=\sum_nf_n\frac{x^n}{n!}
$$</p>
<p>其意义体现在其乘法操作上：
$$
F(x)G(x)=\sum_n\left(\sum_{i=0}^n\binom nif_ig_{n-i}\right)x^i
$$
多出来的$\binom ni$告诉我们它适用于排列的计算（相对于OGF的普通卷积对应组合）。</p>
<p>EGF的运算法则：
$$
\begin{aligned}
\alpha F(x)+\beta G(x)&amp;=\sum_n(\alpha f_n+\beta g_n)\frac{x^n}{n!}\\
x^mF(x)&amp;=\sum_n[n\geq m]n^{\underline m}f_{n-m}\frac{x^n}{n!}\\
\frac{F(x)-\sum_{i=0}^{m-1}f_ix^i}{x^m}&amp;=\sum_n\frac1{(n+m)^{\underline m}}f_{n+m}\frac{x^n}{n!}\\
F(cx)&amp;=\sum_nc^nf_n\frac{x^n}{n!}\\
F^\prime(x)&amp;=\sum_nf_{n+1}\frac{x^n}{n!}\\
\int_0^xF(t)\mathrm{d}t&amp;=\sum_n[n&gt;0]f_{n-1}\frac{x^n}{n!}\\
F(x)G(x)&amp;=\sum_n\left(\sum_{i=0}^n\binom nif_ig_{n-i}\right)\frac{x^n}{n!}
\end{aligned}
$$
同样有一些基本的EGF：</p>
<table>
<thead>
<tr class="header">
<th>数列</th>
<th>EGF</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>$&lt;1,1,1,\dots&gt;$</td>
<td>$e^x$</td>
</tr>
<tr class="even">
<td>$&lt;0,1,2,\dots&gt;$</td>
<td>$xe^x$</td>
</tr>
<tr class="odd">
<td>$&lt;1,c,c^2,\dots&gt;$</td>
<td>$e^{cx}$</td>
</tr>
<tr class="even">
<td>$\dots$</td>
<td>$\dots$</td>
</tr>
</tbody>
</table>
<p>好吧你只需要注意到$&lt;f_n&gt;$的EGF实际上就是$&lt;\frac{f_n}{n!}&gt;$的OGF，就能找到不少例子。</p>
<p>那么EGF又有什么作用呢？</p>
<h4 id="examples-1">Examples</h4>
<h5 id="example-1-1">Example 1</h5>
<p>贝尔数$\omega_n$是把大小为$n$的子集分割成若干非空不相交子集的方案数。</p>
<p>通过枚举第一个元素所在的子集大小$i$，我们可以得到</p>
<p>$$\omega_n=[n=0]+\sum_{i=1}^n\binom{n-1}{i-1}\omega_{n-i}$$</p>
<p>于是其EGF满足</p>
<p>$$F(x)=1+\int_0^xe^tF(t)\mathrm{d}t$$</p>
<p>两边求导
$$
\begin{aligned}
F^\prime(x)&amp;=e^xF(x)\\
\frac{\mathrm{d}F}{\mathrm{d}x}&amp;=e^xF(x)\\
\frac{\mathrm{d}F}F&amp;=e^x\mathrm{d}x\\
\int\frac{\mathrm{d}F}F&amp;=\int e^x\mathrm{d}x\\
\ln F&amp;=e^x+C\\
F&amp;=e^{e^x+C}\\
\end{aligned}
$$
把$F(0)=\omega_0=1$代入即得$F(x)=e^{e^x-1}$。这个多项式的系数可以利用$e^g=\sum_n\frac{g^n}{n!}$计算。</p>
<p>$F(x)=e^{e^x-1}$也可以这样理解：$g(x)=e^x-1$的$n$次项系数是“n个数组成一个非空集合”的方案数（显然），而$g^c(x)$的$n$次项系数（由于EGF对应排列）就是“n个数划分成c个非空集合”的方案数。而由于这$c$个集合是不可区分的，所以要乘上$\frac1{c!}$。于是我们得到$F(x)=\sum_n\frac{g^n(x)}{n!}=e^{g(x)}=e^{e^x-1}$</p>
<p><del>留坑待填</del></p>
<p><del>PS:_rqy太懒了以至于他不想写了</del>
PS2: 已经坑了。</p>

        </main>

        <footer>
            ♥ 由
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
            生成！

            © 遵循
            <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
                CC-BY 4.0
            </a>
            知识共享协议.
        </footer>
    </body>
</html>
