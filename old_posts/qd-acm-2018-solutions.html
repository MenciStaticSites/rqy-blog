<!doctype html>
<html lang="zh-Hans-CN">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>ZOJ4058-4070 Solutions for QingDao ACM 2018 - 清芷的博客</title>
        <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon_3f3okc0t0smnz.png">
        <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32_lrgcr2u2dgnr.png">
        <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16_1siqrekx8ykol.png">
        <link rel="manifest" href="../site.webmanifest">
        <link rel="stylesheet" href="../css/fifthave_3dfyc7189qcwg.css" />
        <link rel="stylesheet" href="../css/syntax_lf612iqmmilx.css" />
        <link rel="stylesheet" href="../css/banana_2lzbro8offw8.css" />
        <link rel="stylesheet" href="../css/katex.min_1koofb1j5udh9.css" />
        <script src="../js/jquery-3.6.1.min_1udo1bomfn0oe.js"></script>
        <script src="../js/proof-collapse_rlvnn55bzvd0.js"></script>
        <script src="../js/table-of-contents_35en0xznwr03i.js"></script>
        
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>

        <!-- To automatically render math in text elements, include the auto-render extension: -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function() {
                renderMathInElement(document.body, {
                    // customised options
                    // ? auto-render specific keys, e.g.:
                    delimiters: [
                        {left: '$$', right: '$$', display: true},
                        {left: '$', right: '$', display: false},
                        {left: '\\(', right: '\\)', display: false},
                        {left: '\\[', right: '\\]', display: true}
                    ],
                    // ? rendering keys, e.g.:
                    throwOnError : false
                });
            });
        </script>
        
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="..">清芷的博客</a>
            </div>
            <nav>
                <a href="..">首页</a>
                <a href="../about.html">关于</a>
                <a href="../contact.html">联系</a>
                <a href="../friends.html">友链</a>
                <a href="../archive.html">归档</a>
            </nav>
        </header>

        <main role="main">
            <h1>ZOJ4058-4070 Solutions for QingDao ACM 2018</h1>
            <div class="info">
    
    2018 年 11 月  7 日发布.
    
</div>

<p>目前 H 不会写，K 不想写...</p>
<!--more-->
<p>要看某道题的题解的话，左边有目录qwq。</p>
<p>下面每个题数据范围里没有标的东西都是不重要的东西（不影响复杂度且不影响做法）。</p>
<p>反正你也不可能看完我的 Blog 再做题就不看题面了。</p>
<h1 id="a-sequence-and-sequence">[A] Sequence and Sequence</h1>
<h2 id="description">Description</h2>
<p>给定序列 $P, Q$, （下标从 1 开始）。</p>
<p>$$
P=\{1,1,2,2,2,3,3,3,3,4,4,4,4,4,5,5,5,5,5,5,\dots\}
$$</p>
<p>$$
Q(n)=\begin{cases}1&amp;n=1\\Q(n-1)+Q(P_n)&amp;n&gt;1\end{cases}
$$</p>
<p>给定 $n$，求 $Q(n)$ 。</p>
<p>数组组数 $T\leqslant10000$，$n\leqslant10^{40}$。5s/512MB</p>
<h2 id="solution">Solution</h2>
<p>首先我们可以发现 $P(n)\geq i\iff n\geq\frac{i(i+1)}2$ 。</p>
<p>补充定义 $Q(0)=0$。因为 $Q(n)$ 的差分为 $Q(P(n))$，容易知道</p>
<p>$$
Q(n)=\sum_{i=1}^nQ(P(i))\\tag{A1}
$$</p>
<p>将 $(A1)$ 代入其本身，我们可以得到</p>
<p>$$
\begin{aligned}
Q(n)&amp;=\sum_{i=1}^nQ(P(i))\\
&amp;=\sum_{i=1}^n\left(\sum_{j=1}^{P(i)}Q(P(j))\right)\\
&amp;=\sum_{j=1}^{P(n)}Q(P(j))\sum_{i=\frac{j(j+1)}2}^n1\\
&amp;=n\sum_{j=1}^{P(n)}Q(P(j))-\sum_{j=1}^{P(n)}Q(P(j))\left(\frac{j(j+1)}2-1\right)\\
\end{aligned}
$$</p>
<p>我们发现求和上指标都从 $n$ 变成了 $P(n)$，但是求和的时候可能会多乘一个关于 $j$ 的多项式。</p>
<p>用完全相同的方式我们可以推出</p>
<p>$$
\sum_{i=1}^nQ(P(i))F(i)=S_F(n)\sum_{j=1}^{P(n)}Q(P(j))-\sum_{j=1}^{P(n)}Q(P(j))S_F\left(\frac{j(j+1)}2-1\right)\\tag{A2}
$$</p>
<p>式中 $S_F(n)$ 表示 $F$ 的前缀和，即 $S_F(n)=\sum_{i=0}^nF(i)$ （从0从1开始无所谓了）。</p>
<p>我们用 $f_{n,F}$ 表示式 $(A2)$ 的左边，$T_F(n)=S_F(n(n+1)/2-1)$ ，则我们有 $f_{n,F}=S_F(n)f_{P(n),1}-f_{P(n),T_F}$ 。</p>
<p>我们要求的 $Q(n)=f_{n,1}$ 。如果我们用 $(A2)$ 展开式子，那么就变成要求 $f_{P(n),1},f_{P(n),T_1}$ ，再展开一次就要求 $f_{P(P(n)),1},f_{P(P(n)), T_1},f_{P(P(n)),T_{T_1}}$，以此类推。</p>
<p>由此我们定义 $F_0(n)=1, F_{i+1}(n)=T_{F_i}(n)$ 为在 $f(n)=1$ 上迭代 $i$ 次 $T$ 得到的多项式；$n_0=n,n_{i+1}=P(n_i)$ 表示在 $n$ 上迭代 $i$ 次 $P$ 得到的数；</p>
<p>再令 $g_{i,k}=f_{n_i,F_k}$，则</p>
<p>$$
g_{i,k}=S_{F_k}(n_i)g_{i+1,0}-g_{i+1,k+1}\\tag{A3}
$$</p>
<p>可以验证 $P(P(P(P(10^{40}))))=605$，所以可以预处理出 $F_0\dots F_4$、所有 $n\leqslant605,k\leqslant4$ 的 $f_{n,F_k}$ 的值，查询的时候直接用 $(A3)$ 不断展开即可。</p>
<h2 id="code">Code</h2>
<p>代码中 $Poly$ 为多项式，表示 $f(x)=(A_0+A_1x+A_2x^2+\dots+A_{deg}x^{deg})\div den$。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cmath&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> LL<span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">610</span><span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LL gcd<span class="op">(</span>LL a<span class="op">,</span> LL b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>b<span class="op">)</span> <span class="bu">std::</span>swap<span class="op">(</span>b<span class="op">,</span> a <span class="op">%=</span> b<span class="op">);</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Poly <span class="op">{</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  LL A<span class="op">[</span><span class="dv">100</span><span class="op">],</span> den<span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> deg<span class="op">;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  Poly<span class="op">(</span><span class="dt">int</span> v <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    deg <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    den <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>A<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span> A<span class="op">);</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    A<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  Poly <span class="op">&amp;</span>reduce<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>deg <span class="op">&amp;&amp;</span> <span class="op">!</span>A<span class="op">[</span>deg<span class="op">])</span> <span class="op">--</span>deg<span class="op">;</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    LL g <span class="op">=</span> den<span class="op">;</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> deg <span class="op">&amp;&amp;</span> g <span class="op">&gt;</span> <span class="dv">1</span><span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> g <span class="op">=</span> gcd<span class="op">(</span>g<span class="op">,</span> A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>g <span class="op">&gt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>      den <span class="op">/=</span> g<span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> deg<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> A<span class="op">[</span>i<span class="op">]</span> <span class="op">/=</span> g<span class="op">;</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">*</span><span class="kw">this</span><span class="op">;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="kw">friend</span> Poly <span class="kw">operator</span><span class="op">*(</span><span class="at">const</span> Poly <span class="op">&amp;</span>a<span class="op">,</span> <span class="at">const</span> Poly <span class="op">&amp;</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    Poly ans<span class="op">;</span> ans<span class="op">.</span>deg <span class="op">=</span> a<span class="op">.</span>deg <span class="op">+</span> b<span class="op">.</span>deg<span class="op">;</span> ans<span class="op">.</span>den <span class="op">=</span> a<span class="op">.</span>den <span class="op">*</span> b<span class="op">.</span>den<span class="op">;</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> a<span class="op">.</span>deg<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;=</span> b<span class="op">.</span>deg<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>        ans<span class="op">.</span>A<span class="op">[</span>i <span class="op">+</span> j<span class="op">]</span> <span class="op">+=</span> a<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> b<span class="op">.</span>A<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">.</span>reduce<span class="op">();</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="kw">friend</span> Poly <span class="kw">operator</span><span class="op">*(</span><span class="at">const</span> Poly <span class="op">&amp;</span>a<span class="op">,</span> LL b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    Poly ans<span class="op">;</span> ans<span class="op">.</span>deg <span class="op">=</span> a<span class="op">.</span>deg<span class="op">;</span> ans<span class="op">.</span>den <span class="op">=</span> a<span class="op">.</span>den<span class="op">;</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> ans<span class="op">.</span>deg<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> ans<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">+=</span> a<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> b<span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">.</span>reduce<span class="op">();</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="kw">friend</span> Poly <span class="kw">operator</span><span class="op">/(</span><span class="at">const</span> Poly <span class="op">&amp;</span>a<span class="op">,</span> LL b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    Poly ans<span class="op">;</span> ans<span class="op">.</span>deg <span class="op">=</span> a<span class="op">.</span>deg<span class="op">;</span> ans<span class="op">.</span>den <span class="op">=</span> a<span class="op">.</span>den <span class="op">*</span> b<span class="op">;</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> ans<span class="op">.</span>deg<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> ans<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> a<span class="op">.</span>A<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">.</span>reduce<span class="op">();</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>  <span class="kw">friend</span> Poly <span class="kw">operator</span><span class="op">+(</span><span class="at">const</span> Poly <span class="op">&amp;</span>a<span class="op">,</span> <span class="at">const</span> Poly <span class="op">&amp;</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    Poly ans<span class="op">;</span> ans<span class="op">.</span>deg <span class="op">=</span> <span class="bu">std::</span>max<span class="op">(</span>a<span class="op">.</span>deg<span class="op">,</span> b<span class="op">.</span>deg<span class="op">);</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>    ans<span class="op">.</span>den <span class="op">=</span> a<span class="op">.</span>den <span class="op">*</span> b<span class="op">.</span>den <span class="op">/</span> gcd<span class="op">(</span>a<span class="op">.</span>den<span class="op">,</span> b<span class="op">.</span>den<span class="op">);</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    LL xa <span class="op">=</span> ans<span class="op">.</span>den <span class="op">/</span> a<span class="op">.</span>den<span class="op">,</span> xb <span class="op">=</span> ans<span class="op">.</span>den <span class="op">/</span> b<span class="op">.</span>den<span class="op">;</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> ans<span class="op">.</span>deg<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>      ans<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> a<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> xa <span class="op">+</span> b<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> xb<span class="op">;</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">.</span>reduce<span class="op">();</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  <span class="kw">friend</span> Poly <span class="kw">operator</span><span class="op">-(</span><span class="at">const</span> Poly <span class="op">&amp;</span>a<span class="op">,</span> <span class="at">const</span> Poly <span class="op">&amp;</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>    Poly ans<span class="op">;</span> ans<span class="op">.</span>deg <span class="op">=</span> <span class="bu">std::</span>max<span class="op">(</span>a<span class="op">.</span>deg<span class="op">,</span> b<span class="op">.</span>deg<span class="op">);</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    ans<span class="op">.</span>den <span class="op">=</span> a<span class="op">.</span>den <span class="op">*</span> b<span class="op">.</span>den <span class="op">/</span> gcd<span class="op">(</span>a<span class="op">.</span>den<span class="op">,</span> b<span class="op">.</span>den<span class="op">);</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>    LL xa <span class="op">=</span> ans<span class="op">.</span>den <span class="op">/</span> a<span class="op">.</span>den<span class="op">,</span> xb <span class="op">=</span> ans<span class="op">.</span>den <span class="op">/</span> b<span class="op">.</span>den<span class="op">;</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> ans<span class="op">.</span>deg<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>      ans<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> a<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> xa <span class="op">-</span> b<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> xb<span class="op">;</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">.</span>reduce<span class="op">();</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>  <span class="kw">template</span> <span class="op">&lt;</span><span class="kw">typename</span> T<span class="op">&gt;</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>  T <span class="kw">operator</span><span class="op">()(</span><span class="at">const</span> T <span class="op">&amp;</span>x<span class="op">)</span> <span class="at">const</span> <span class="op">{</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>    T ans<span class="op">(</span><span class="dv">0</span><span class="op">),</span> ans1<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> deg<span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> <span class="op">--</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>      ans <span class="op">=</span> ans <span class="op">*</span> x<span class="op">;</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> ans <span class="op">=</span> ans <span class="op">+</span> A<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> deg<span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> <span class="op">--</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>      ans1 <span class="op">=</span> ans1 <span class="op">*</span> x<span class="op">;</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> ans1 <span class="op">=</span> ans1 <span class="op">+</span> <span class="op">(-</span>A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">-</span> ans1<span class="op">)</span> <span class="op">/</span> den<span class="op">;</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> W <span class="op">=</span> <span class="dv">1000000</span><span class="op">;</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Integer <span class="op">{</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>  LL A<span class="op">[</span><span class="dv">15</span><span class="op">],</span> len<span class="op">;</span></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>  Integer<span class="op">(</span>LL v <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>    len <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>A<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span> A<span class="op">);</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>v<span class="op">)</span> A<span class="op">[</span>len<span class="op">++]</span> <span class="op">=</span> v <span class="op">%</span> W<span class="op">,</span> v <span class="op">/=</span> W<span class="op">;</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>  <span class="kw">friend</span> Integer <span class="kw">operator</span><span class="op">+(</span><span class="at">const</span> Integer <span class="op">&amp;</span>a<span class="op">,</span> <span class="at">const</span> Integer <span class="op">&amp;</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>    Integer ans<span class="op">;</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    ans<span class="op">.</span>len <span class="op">=</span> <span class="bu">std::</span>max<span class="op">(</span>a<span class="op">.</span>len<span class="op">,</span> b<span class="op">.</span>len<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> ans<span class="op">.</span>len<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>      t <span class="op">=</span> <span class="op">(</span>ans<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> a<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> b<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> t<span class="op">)</span> <span class="op">/</span> W<span class="op">;</span></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>      ans<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">%=</span> W<span class="op">;</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>ans<span class="op">.</span>len <span class="op">&amp;&amp;</span> <span class="op">!</span>ans<span class="op">.</span>A<span class="op">[</span>ans<span class="op">.</span>len <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">--</span>ans<span class="op">.</span>len<span class="op">;</span></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true" tabindex="-1"></a>  <span class="kw">friend</span> Integer <span class="kw">operator</span><span class="op">-(</span><span class="at">const</span> Integer <span class="op">&amp;</span>a<span class="op">,</span> <span class="at">const</span> Integer <span class="op">&amp;</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true" tabindex="-1"></a>    Integer ans<span class="op">;</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true" tabindex="-1"></a>    ans<span class="op">.</span>len <span class="op">=</span> a<span class="op">.</span>len<span class="op">;</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> ans<span class="op">.</span>len<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true" tabindex="-1"></a>      t <span class="op">=</span> <span class="op">(</span>ans<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> a<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> b<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> t<span class="op">)</span> <span class="op">&lt;</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>t<span class="op">)</span> ans<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">+=</span> W<span class="op">;</span></span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>ans<span class="op">.</span>len <span class="op">&amp;&amp;</span> <span class="op">!</span>ans<span class="op">.</span>A<span class="op">[</span>ans<span class="op">.</span>len <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">--</span>ans<span class="op">.</span>len<span class="op">;</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true" tabindex="-1"></a>  <span class="kw">friend</span> Integer <span class="kw">operator</span><span class="op">*(</span><span class="at">const</span> Integer <span class="op">&amp;</span>a<span class="op">,</span> <span class="at">const</span> Integer <span class="op">&amp;</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true" tabindex="-1"></a>    Integer ans<span class="op">;</span></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true" tabindex="-1"></a>    ans<span class="op">.</span>len <span class="op">=</span> a<span class="op">.</span>len <span class="op">+</span> b<span class="op">.</span>len<span class="op">;</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> a<span class="op">.</span>len<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> b<span class="op">.</span>len<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span></span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true" tabindex="-1"></a>        ans<span class="op">.</span>A<span class="op">[</span>i <span class="op">+</span> j<span class="op">]</span> <span class="op">+=</span> a<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> b<span class="op">.</span>A<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> ans<span class="op">.</span>len<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true" tabindex="-1"></a>      ans<span class="op">.</span>A<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+=</span> ans<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">/</span> W<span class="op">;</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true" tabindex="-1"></a>      ans<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">%=</span> W<span class="op">;</span></span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>ans<span class="op">.</span>len <span class="op">&amp;&amp;</span> <span class="op">!</span>ans<span class="op">.</span>A<span class="op">[</span>ans<span class="op">.</span>len <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">--</span>ans<span class="op">.</span>len<span class="op">;</span></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true" tabindex="-1"></a>  <span class="kw">friend</span> Integer <span class="kw">operator</span><span class="op">/(</span><span class="at">const</span> Integer <span class="op">&amp;</span>a<span class="op">,</span> LL b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true" tabindex="-1"></a>    Integer ans<span class="op">;</span></span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true" tabindex="-1"></a>    ans<span class="op">.</span>len <span class="op">=</span> a<span class="op">.</span>len<span class="op">;</span></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true" tabindex="-1"></a>    LL t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> a<span class="op">.</span>len <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> <span class="op">--</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true" tabindex="-1"></a>      LL k <span class="op">=</span> a<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> t <span class="op">*</span> W<span class="op">;</span></span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true" tabindex="-1"></a>      ans<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> k <span class="op">/</span> b<span class="op">;</span></span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true" tabindex="-1"></a>      t <span class="op">=</span> k <span class="op">%</span> b<span class="op">;</span></span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>ans<span class="op">.</span>len <span class="op">&amp;&amp;</span> <span class="op">!</span>ans<span class="op">.</span>A<span class="op">[</span>ans<span class="op">.</span>len <span class="op">-</span> <span class="dv">1</span><span class="op">])</span> <span class="op">--</span>ans<span class="op">.</span>len<span class="op">;</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true" tabindex="-1"></a>  <span class="kw">friend</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">!=(</span><span class="at">const</span> Integer <span class="op">&amp;</span>a<span class="op">,</span> <span class="at">const</span> Integer <span class="op">&amp;</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a<span class="op">.</span>len <span class="op">!=</span> b<span class="op">.</span>len<span class="op">)</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> a<span class="op">.</span>len<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>a<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> b<span class="op">.</span>A<span class="op">[</span>i<span class="op">])</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true" tabindex="-1"></a>  <span class="kw">friend</span> <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;=(</span><span class="at">const</span> Integer <span class="op">&amp;</span>a<span class="op">,</span> <span class="at">const</span> Integer <span class="op">&amp;</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a<span class="op">.</span>len <span class="op">!=</span> b<span class="op">.</span>len<span class="op">)</span> <span class="cf">return</span> a<span class="op">.</span>len <span class="op">&lt;</span> b<span class="op">.</span>len<span class="op">;</span></span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> a<span class="op">.</span>len<span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> <span class="op">--</span>i<span class="op">)</span></span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>a<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> b<span class="op">.</span>A<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">.</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">&lt;=</span> b<span class="op">.</span>A<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true" tabindex="-1"></a>  <span class="dt">void</span> put<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="at">const</span> <span class="op">{</span></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>len<span class="op">)</span> putchar<span class="op">(</span><span class="ch">'0'</span><span class="op">),</span> putchar<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true" tabindex="-1"></a>      printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st">&quot;</span><span class="op">,</span> A<span class="op">[</span>len <span class="op">-</span> <span class="dv">1</span><span class="op">]);</span></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> len <span class="op">-</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> <span class="op">--</span>i<span class="op">)</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%06lld</span><span class="st">&quot;</span><span class="op">,</span> A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true" tabindex="-1"></a>      putchar<span class="op">(</span>c<span class="op">);</span></span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true" tabindex="-1"></a>Poly X<span class="op">,</span> K<span class="op">,</span> pX1<span class="op">[</span><span class="dv">35</span><span class="op">],</span> Sk<span class="op">[</span><span class="dv">35</span><span class="op">],</span> F<span class="op">[</span><span class="dv">5</span><span class="op">],</span> S<span class="op">[</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true" tabindex="-1"></a>Poly getS<span class="op">(</span><span class="at">const</span> Poly <span class="op">&amp;</span>a<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true" tabindex="-1"></a>  Poly ans<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> a<span class="op">.</span>deg<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">=</span> ans <span class="op">+</span> Sk<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> a<span class="op">.</span>A<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true" tabindex="-1"></a>  ans <span class="op">=</span> ans <span class="op">/</span> a<span class="op">.</span>den<span class="op">;</span></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> InitF<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true" tabindex="-1"></a>  X<span class="op">.</span>deg <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true" tabindex="-1"></a>  X<span class="op">.</span>A<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true" tabindex="-1"></a>  pX1<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">35</span><span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> pX1<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> pX1<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span>X <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">34</span><span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true" tabindex="-1"></a>    Sk<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> pX1<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> C <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> i<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true" tabindex="-1"></a>      Sk<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> Sk<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> Sk<span class="op">[</span>j<span class="op">]</span> <span class="op">*</span> C<span class="op">;</span></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true" tabindex="-1"></a>      C <span class="op">=</span> C <span class="op">*</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> j<span class="op">)</span> <span class="op">/</span> <span class="op">(</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true" tabindex="-1"></a>    Sk<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> Sk<span class="op">[</span>i<span class="op">]</span> <span class="op">/</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true" tabindex="-1"></a>  K <span class="op">=</span> X <span class="op">*</span> <span class="op">(</span>X <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true" tabindex="-1"></a>  S<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> getS<span class="op">(</span>F<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true" tabindex="-1"></a>    S<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> getS<span class="op">(</span>F<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> S<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">](</span>K<span class="op">).</span>reduce<span class="op">());</span></span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> P<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true" tabindex="-1"></a>LL Q<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true" tabindex="-1"></a>Integer SS<span class="op">[</span><span class="dv">5</span><span class="op">][</span>N<span class="op">];</span></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> InitPQ<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">*</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">&lt;</span> N<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> i <span class="op">*</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span> j <span class="op">&lt;</span> N <span class="op">&amp;&amp;</span> j <span class="op">&lt;</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">2</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span> <span class="op">++</span>j<span class="op">)</span></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true" tabindex="-1"></a>      P<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true" tabindex="-1"></a>  Q<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true" tabindex="-1"></a>    Q<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> Q<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> Q<span class="op">[</span>P<span class="op">[</span>i<span class="op">]];</span></span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true" tabindex="-1"></a>    SS<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> N<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span></span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true" tabindex="-1"></a>      SS<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> SS<span class="op">[</span>i<span class="op">][</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> Q<span class="op">[</span>P<span class="op">[</span>j<span class="op">]]</span> <span class="op">*</span> F<span class="op">[</span>i<span class="op">]((</span>Integer<span class="op">)</span>j<span class="op">);</span></span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> LL k<span class="op">(</span>LL x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> x <span class="op">*</span> <span class="op">(</span>x <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true" tabindex="-1"></a>Integer getP<span class="op">(</span>Integer n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true" tabindex="-1"></a>  <span class="co">// x^2+x-2n&lt;=0</span></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true" tabindex="-1"></a>  <span class="co">// x&lt;=(sqrt(1+8n)-1)/2</span></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true" tabindex="-1"></a>  Integer l <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> r <span class="op">=</span> n<span class="op">,</span> q <span class="op">=</span> n <span class="op">*</span> <span class="dv">2</span><span class="op">,</span> mid<span class="op">;</span></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>l <span class="op">!=</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true" tabindex="-1"></a>    mid <span class="op">=</span> <span class="op">(</span>l <span class="op">+</span> r <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>mid <span class="op">*</span> <span class="op">(</span>mid <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">&lt;=</span> q<span class="op">)</span> l <span class="op">=</span> mid<span class="op">;</span></span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> r <span class="op">=</span> mid <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> l<span class="op">;</span></span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true" tabindex="-1"></a>Integer mem<span class="op">[</span><span class="dv">5</span><span class="op">][</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> vis<span class="op">[</span><span class="dv">5</span><span class="op">][</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true" tabindex="-1"></a>Integer nn<span class="op">[</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true" tabindex="-1"></a>Integer calc<span class="op">(</span><span class="dt">int</span> i<span class="op">,</span> <span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> Integer <span class="op">&amp;</span>n <span class="op">=</span> nn<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>n<span class="op">.</span>len <span class="op">&lt;=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> n<span class="op">.</span>A<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">&lt;</span> N<span class="op">)</span> <span class="cf">return</span> SS<span class="op">[</span>k<span class="op">][</span>n<span class="op">.</span>A<span class="op">[</span><span class="dv">0</span><span class="op">]];</span></span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>vis<span class="op">[</span>i<span class="op">][</span>k<span class="op">])</span> <span class="cf">return</span> mem<span class="op">[</span>i<span class="op">][</span>k<span class="op">];</span></span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true" tabindex="-1"></a>  vis<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> mem<span class="op">[</span>i<span class="op">][</span>k<span class="op">]</span> <span class="op">=</span> S<span class="op">[</span>k<span class="op">](</span>n<span class="op">)</span> <span class="op">*</span> calc<span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">)</span> <span class="op">-</span> calc<span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> k <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> s<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true" tabindex="-1"></a>  InitF<span class="op">();</span></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true" tabindex="-1"></a>  InitPQ<span class="op">();</span></span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> T<span class="op">;</span></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>T<span class="op">);</span></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>T<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%s</span><span class="st">&quot;</span><span class="op">,</span> s<span class="op">);</span></span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true" tabindex="-1"></a>    nn<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> s<span class="op">[</span>i<span class="op">];</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true" tabindex="-1"></a>      nn<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> nn<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> <span class="ch">'0'</span><span class="op">);</span></span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> nn<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> getP<span class="op">(</span>nn<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]);</span></span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true" tabindex="-1"></a>    memset<span class="op">(</span>vis<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span> vis<span class="op">);</span></span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true" tabindex="-1"></a>    calc<span class="op">(</span><span class="dv">0</span><span class="op">).</span>put<span class="op">(</span><span class="ch">'</span><span class="sc">\n</span><span class="ch">'</span><span class="op">);</span></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="b-kawa-exam">[B] Kawa Exam</h1>
<h2 id="description-1">Description</h2>
<p>给定一张无向图，每个点有一个目标颜色。现在对于每条边求出：</p>
<ul>
<li>删除这条边之后，给每个点染色，要求单个联通块内颜色相同，且满足目标颜色的点最多，求最多多少个点满足目标颜色。</li>
</ul>
<p>$n,m\leqslant10^5$，$\sum n,\sum m\leqslant10^6$。2s/64MB</p>
<h2 id="solution-1">Solution</h2>
<p>显然删边之后每个连通块取其众数；而且只有割边删掉答案才会变。</p>
<p>所以边双连通分量缩成一个点之后只需要在树上做这个操作，容易发现要求的其实就是子树众数和子树外众数。</p>
<p>可以直接 dsu on tree 解决，复杂度 $O(n\log n+m)$。附：<a href="http://codeforces.com/blog/entry/44351">Tutorial (dsu on tree)</a></p>
<h2 id="code-1">Code</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">100050</span><span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> VI<span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Tree <span class="op">{</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>VI C<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> pre<span class="op">[</span>N<span class="op">],</span> nxt<span class="op">[</span>N <span class="op">*</span> <span class="dv">2</span><span class="op">],</span> to<span class="op">[</span>N <span class="op">*</span> <span class="dv">2</span><span class="op">],</span> cnt<span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> siz<span class="op">[</span>N<span class="op">],</span> wson<span class="op">[</span>N<span class="op">],</span> ans1<span class="op">[</span>N<span class="op">],</span> ans2<span class="op">[</span>N<span class="op">],</span> root<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sumAns<span class="op">;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> addEdge<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  nxt<span class="op">[</span>cnt<span class="op">]</span> <span class="op">=</span> pre<span class="op">[</span>x<span class="op">];</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  to<span class="op">[</span>pre<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> cnt<span class="op">++]</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  nxt<span class="op">[</span>cnt<span class="op">]</span> <span class="op">=</span> pre<span class="op">[</span>y<span class="op">];</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  to<span class="op">[</span>pre<span class="op">[</span>y<span class="op">]</span> <span class="op">=</span> cnt<span class="op">++]</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs0<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  root<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> f <span class="op">?</span> root<span class="op">[</span>f<span class="op">]</span> <span class="op">:</span> x<span class="op">;</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  siz<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> C<span class="op">[</span>x<span class="op">].</span>size<span class="op">();</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  wson<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> pre<span class="op">[</span>x<span class="op">];</span> <span class="op">~</span>i<span class="op">;</span> i <span class="op">=</span> nxt<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>to<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>      dfs0<span class="op">(</span>to<span class="op">[</span>i<span class="op">],</span> x<span class="op">);</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>      siz<span class="op">[</span>x<span class="op">]</span> <span class="op">+=</span> siz<span class="op">[</span>to<span class="op">[</span>i<span class="op">]];</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>siz<span class="op">[</span>to<span class="op">[</span>i<span class="op">]]</span> <span class="op">&gt;</span> siz<span class="op">[</span>wson<span class="op">[</span>x<span class="op">]])</span> wson<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> to<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> SomeDS <span class="op">{</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> A<span class="op">[</span>N<span class="op">],</span> num<span class="op">[</span>N<span class="op">],</span> maxv<span class="op">;</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="kw">inline</span> <span class="dt">void</span> add1<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span> <span class="op">--</span>num<span class="op">[</span>A<span class="op">[</span>x<span class="op">]];</span> <span class="op">++</span>num<span class="op">[++</span>A<span class="op">[</span>x<span class="op">]];</span> maxv <span class="op">+=</span> num<span class="op">[</span>maxv <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="kw">inline</span> <span class="dt">void</span> minus1<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span> <span class="op">--</span>num<span class="op">[</span>A<span class="op">[</span>x<span class="op">]];</span> <span class="op">++</span>num<span class="op">[--</span>A<span class="op">[</span>x<span class="op">]];</span> maxv <span class="op">-=</span> num<span class="op">[</span>maxv<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> D<span class="op">;</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> forall<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> f<span class="op">,</span> <span class="dt">void</span> <span class="op">(</span>SomeDS<span class="op">::*</span>fun<span class="op">)(</span><span class="dt">int</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>VI<span class="op">::</span>iterator i <span class="op">=</span> C<span class="op">[</span>x<span class="op">].</span>begin<span class="op">();</span> i <span class="op">!=</span> C<span class="op">[</span>x<span class="op">].</span>end<span class="op">();</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="op">(</span>D<span class="op">.*</span>fun<span class="op">)(*</span>i<span class="op">);</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> pre<span class="op">[</span>x<span class="op">];</span> <span class="op">~</span>i<span class="op">;</span> i <span class="op">=</span> nxt<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>to<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> f<span class="op">)</span> forall<span class="op">(</span>to<span class="op">[</span>i<span class="op">],</span> x<span class="op">,</span> fun<span class="op">);</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs1<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> f<span class="op">,</span> <span class="dt">bool</span> keep<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> pre<span class="op">[</span>x<span class="op">];</span> <span class="op">~</span>i<span class="op">;</span> i <span class="op">=</span> nxt<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>to<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> f <span class="op">&amp;&amp;</span> to<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> wson<span class="op">[</span>x<span class="op">])</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>      dfs1<span class="op">(</span>to<span class="op">[</span>i<span class="op">],</span> x<span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>wson<span class="op">[</span>x<span class="op">])</span> dfs1<span class="op">(</span>wson<span class="op">[</span>x<span class="op">],</span> x<span class="op">,</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>VI<span class="op">::</span>iterator i <span class="op">=</span> C<span class="op">[</span>x<span class="op">].</span>begin<span class="op">();</span> i <span class="op">!=</span> C<span class="op">[</span>x<span class="op">].</span>end<span class="op">();</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    D<span class="op">.</span>add1<span class="op">(*</span>i<span class="op">);</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> pre<span class="op">[</span>x<span class="op">];</span> <span class="op">~</span>i<span class="op">;</span> i <span class="op">=</span> nxt<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>to<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> f <span class="op">&amp;&amp;</span> to<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> wson<span class="op">[</span>x<span class="op">])</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>      forall<span class="op">(</span>to<span class="op">[</span>i<span class="op">],</span> x<span class="op">,</span> <span class="op">&amp;</span>SomeDS<span class="op">::</span>add1<span class="op">);</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  ans1<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> D<span class="op">.</span>maxv<span class="op">;</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(!</span>keep<span class="op">)</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    forall<span class="op">(</span>x<span class="op">,</span> f<span class="op">,</span> <span class="op">&amp;</span>SomeDS<span class="op">::</span>minus1<span class="op">);</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs2<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> f<span class="op">,</span> <span class="dt">bool</span> keep<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> pre<span class="op">[</span>x<span class="op">];</span> <span class="op">~</span>i<span class="op">;</span> i <span class="op">=</span> nxt<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>to<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> f <span class="op">&amp;&amp;</span> to<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> wson<span class="op">[</span>x<span class="op">])</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>      dfs2<span class="op">(</span>to<span class="op">[</span>i<span class="op">],</span> x<span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>wson<span class="op">[</span>x<span class="op">])</span> dfs2<span class="op">(</span>wson<span class="op">[</span>x<span class="op">],</span> x<span class="op">,</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>VI<span class="op">::</span>iterator i <span class="op">=</span> C<span class="op">[</span>x<span class="op">].</span>begin<span class="op">();</span> i <span class="op">!=</span> C<span class="op">[</span>x<span class="op">].</span>end<span class="op">();</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    D<span class="op">.</span>minus1<span class="op">(*</span>i<span class="op">);</span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> pre<span class="op">[</span>x<span class="op">];</span> <span class="op">~</span>i<span class="op">;</span> i <span class="op">=</span> nxt<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>to<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> f <span class="op">&amp;&amp;</span> to<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> wson<span class="op">[</span>x<span class="op">])</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>      forall<span class="op">(</span>to<span class="op">[</span>i<span class="op">],</span> x<span class="op">,</span> <span class="op">&amp;</span>SomeDS<span class="op">::</span>minus1<span class="op">);</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>  ans2<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> D<span class="op">.</span>maxv<span class="op">;</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(!</span>keep<span class="op">)</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    forall<span class="op">(</span>x<span class="op">,</span> f<span class="op">,</span> <span class="op">&amp;</span>SomeDS<span class="op">::</span>add1<span class="op">);</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> Init<span class="op">(</span><span class="dt">int</span> nn<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>  n <span class="op">=</span> nn<span class="op">;</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    pre<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    C<span class="op">[</span>i<span class="op">].</span>clear<span class="op">();</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    root<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>  cnt <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> Solve<span class="op">()</span> <span class="op">{</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>  sumAns <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>root<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>      dfs0<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>      dfs1<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>      dfs2<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>      sumAns <span class="op">+=</span> ans1<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">int</span> getAns<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>a <span class="op">==</span> b<span class="op">)</span> <span class="cf">return</span> sumAns<span class="op">;</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>siz<span class="op">[</span>a<span class="op">]</span> <span class="op">&lt;</span> siz<span class="op">[</span>b<span class="op">])</span> <span class="cf">return</span> sumAns <span class="op">-</span> ans1<span class="op">[</span>root<span class="op">[</span>a<span class="op">]]</span> <span class="op">+</span> ans1<span class="op">[</span>a<span class="op">]</span> <span class="op">+</span> ans2<span class="op">[</span>a<span class="op">];</span></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>                 <span class="cf">return</span> sumAns <span class="op">-</span> ans1<span class="op">[</span>root<span class="op">[</span>b<span class="op">]]</span> <span class="op">+</span> ans1<span class="op">[</span>b<span class="op">]</span> <span class="op">+</span> ans2<span class="op">[</span>b<span class="op">];</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a><span class="kw">namespace</span> Graph <span class="op">{</span></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> pre<span class="op">[</span>N<span class="op">],</span> nxt<span class="op">[</span>N <span class="op">*</span> <span class="dv">2</span><span class="op">],</span> to<span class="op">[</span>N <span class="op">*</span> <span class="dv">2</span><span class="op">],</span> cnt<span class="op">;</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> color<span class="op">[</span>N<span class="op">],</span> dfn<span class="op">[</span>N<span class="op">],</span> bcc<span class="op">[</span>N<span class="op">],</span> cnt2<span class="op">,</span> cnt3<span class="op">;</span></span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> stack<span class="op">[</span>N<span class="op">],</span> ans<span class="op">[</span>N<span class="op">],</span> top<span class="op">;</span></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> addEdge<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>  nxt<span class="op">[</span>cnt<span class="op">]</span> <span class="op">=</span> pre<span class="op">[</span>x<span class="op">];</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>  to<span class="op">[</span>pre<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> cnt<span class="op">++]</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>  nxt<span class="op">[</span>cnt<span class="op">]</span> <span class="op">=</span> pre<span class="op">[</span>y<span class="op">];</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>  to<span class="op">[</span>pre<span class="op">[</span>y<span class="op">]</span> <span class="op">=</span> cnt<span class="op">++]</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> Init<span class="op">(</span><span class="dt">int</span> nn<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>  n <span class="op">=</span> nn<span class="op">;</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> pre<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> dfn<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>  cnt <span class="op">=</span> cnt2 <span class="op">=</span> cnt3 <span class="op">=</span> top <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dfs<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>  stack<span class="op">[</span>top<span class="op">++]</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> lowx <span class="op">=</span> dfn<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> <span class="op">++</span>cnt2<span class="op">;</span></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> pre<span class="op">[</span>x<span class="op">];</span> <span class="op">~</span>i<span class="op">;</span> i <span class="op">=</span> nxt<span class="op">[</span>i<span class="op">])</span> <span class="cf">if</span> <span class="op">((</span>i <span class="op">^</span> <span class="dv">1</span><span class="op">)</span> <span class="op">!=</span> f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>dfn<span class="op">[</span>to<span class="op">[</span>i<span class="op">]])</span> lowx <span class="op">=</span> <span class="bu">std::</span>min<span class="op">(</span>lowx<span class="op">,</span> dfs<span class="op">(</span>to<span class="op">[</span>i<span class="op">],</span> i<span class="op">));</span></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> lowx <span class="op">=</span> <span class="bu">std::</span>min<span class="op">(</span>lowx<span class="op">,</span> dfn<span class="op">[</span>to<span class="op">[</span>i<span class="op">]]);</span></span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>lowx <span class="op">==</span> dfn<span class="op">[</span>x<span class="op">])</span> <span class="op">{</span></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>    bcc<span class="op">[</span>x<span class="op">]</span> <span class="op">=</span> <span class="op">++</span>cnt3<span class="op">;</span></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>stack<span class="op">[--</span>top<span class="op">]</span> <span class="op">!=</span> x<span class="op">)</span> bcc<span class="op">[</span>stack<span class="op">[</span>top<span class="op">]]</span> <span class="op">=</span> cnt3<span class="op">;</span></span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> lowx<span class="op">;</span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> Solve<span class="op">()</span> <span class="op">{</span></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="cf">if</span> <span class="op">(!</span>dfn<span class="op">[</span>i<span class="op">])</span> dfs<span class="op">(</span>i<span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>  Tree<span class="op">::</span>Init<span class="op">(</span>cnt3<span class="op">);</span></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>    Tree<span class="op">::</span>C<span class="op">[</span>bcc<span class="op">[</span>i<span class="op">]].</span>push_back<span class="op">(</span>color<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> cnt<span class="op">;</span> i <span class="op">+=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> to<span class="op">[</span>i<span class="op">],</span> y <span class="op">=</span> to<span class="op">[</span>i <span class="op">^</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>bcc<span class="op">[</span>x<span class="op">]</span> <span class="op">!=</span> bcc<span class="op">[</span>y<span class="op">])</span> Tree<span class="op">::</span>addEdge<span class="op">(</span>bcc<span class="op">[</span>x<span class="op">],</span> bcc<span class="op">[</span>y<span class="op">]);</span></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>  Tree<span class="op">::</span>Solve<span class="op">();</span></span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> cnt<span class="op">;</span> i <span class="op">+=</span> <span class="dv">2</span><span class="op">)</span></span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>    ans<span class="op">[</span>i <span class="op">&gt;&gt;</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> Tree<span class="op">::</span>getAns<span class="op">(</span>bcc<span class="op">[</span>to<span class="op">[</span>i<span class="op">]],</span> bcc<span class="op">[</span>to<span class="op">[</span>i <span class="op">^</span> <span class="dv">1</span><span class="op">]]);</span></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> T<span class="op">;</span></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>T<span class="op">);</span></span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>T<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span> m<span class="op">;</span></span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">,</span> <span class="op">&amp;</span>m<span class="op">);</span></span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>    Graph<span class="op">::</span>Init<span class="op">(</span>n<span class="op">);</span></span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>Graph<span class="op">::</span>color<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> m<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>      <span class="dt">int</span> x<span class="op">,</span> y<span class="op">;</span></span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>      scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>y<span class="op">);</span></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>      Graph<span class="op">::</span>addEdge<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>    Graph<span class="op">::</span>Solve<span class="op">();</span></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> m<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>      printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%c</span><span class="st">&quot;</span><span class="op">,</span> Graph<span class="op">::</span>ans<span class="op">[</span>i<span class="op">],</span> <span class="st">&quot; </span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">[</span>i <span class="op">==</span> m <span class="op">-</span> <span class="dv">1</span><span class="op">]);</span></span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="c-flippy-sequence">[C] Flippy Sequence</h1>
<h2 id="description-2">Description</h2>
<p>给出两个长为 $n$ 的 01 串，你可以（且必须）在两个 01 串中各选择一个区间反转（$0\to1,1\to0$），问有多少种方案使操作后两个串相同。</p>
<p>$n\leqslant10^6,\sum n\leqslant10^7$。1s/64MB</p>
<h2 id="solution-2">Solution</h2>
<p>先把两个串异或起来（假设结果串是 $C$），相当于选择两个（有顺序）的区间使得这两个区间异或起来得到两个串的异或。</p>
<p>当 $C$ 中只含 0 的时候，任意两个相同的区间都可以，方案数是 $\frac{n(n+1)}2$；</p>
<p>当 $C$ 中有一段连续的 1 而其他都是 0 的时候，手玩一下就可以知道恰好有 $2n-2$ 种方案（注意两个区间有顺序）；</p>
<p>当 $C$ 中恰有两段连续的 1 的时候，方案数是 $6$。</p>
<p>当 $C$ 中有三段或以上连续的 1 的时候，显然方案数是 $0$。</p>
<h2 id="code-2">Code</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">1000050</span><span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> s<span class="op">[</span>N<span class="op">],</span> t<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> T<span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>T<span class="op">);</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>T<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%s%s</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">,</span> s<span class="op">,</span> t<span class="op">);</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> l <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">int</span> x <span class="op">=</span> s<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> t<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>x <span class="op">&amp;&amp;</span> <span class="op">!</span>l<span class="op">)</span> <span class="op">++</span>k<span class="op">;</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>      l <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>k <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">(</span><span class="dt">long</span> <span class="dt">long</span><span class="op">)</span>n <span class="op">*</span> <span class="op">(</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>k <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="dv">2</span> <span class="op">*</span> n <span class="op">-</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>k <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="d-magic-multiplication">[D] Magic Multiplication</h1>
<h2 id="description-3">Description</h2>
<p>对于两个正整数 $A, B$，若 $A$ 的各个数位（从高到低，无前导零）为 $a_1,a_2,\dots,a_n$，$B$ 的各个数位为 $b_1,b_2,\dots,b_m$，则定义</p>
<p>$$
A\otimes B=a_1b_1+a_1b_2+a_1b_3+\dots+a_1b_m+a_2b_1+\dots+a_2b_m+\dots+a_nb_m
$$</p>
<p>但是式子中的 $+$ 表示拼接操作，比如</p>
<p>$12+34=1234,0+2=02,23\otimes45=8101215,20\otimes20=4000$。</p>
<p>给出 $n,m$ 及 $C=A\otimes B$，求 $A$ 和 $B$。若有多解输出 $A$ 最小的，还有多解则输出 $B$ 最小的。</p>
<p>$n,m,|C|\leqslant2\times10^5,\sum|C|\leqslant2\times10^6$。1s/64MB</p>
<h2 id="solution-3">Solution</h2>
<p>假设我们知道了 $a_1$。那么如果 $c_1&lt;a_1$，显然 $c_1$ 和 $c_2$ 两位拼起来才是 $a_1\times b_1$，由此可以求出 $b_1$。</p>
<p>否则 $c_1\leqslant a_1$，而如果 $a_1b_1$ 进了位也不会进到 $a_1$ 那么多，所以 $a_1b_1=c_1$，也可以求出 $b_1$。</p>
<p>按照这种方式继续求 $b_2\dots b_m$（注意如果某一次开头一位是 $0$ 的话 $b_i$ 也一定是 $0$），然后反过来用 $b_1$ 求 $a_2,a_3\dots a_n$，在中间的部分直接用 $a_ib_j$ 去跟当前的位置比较即可。</p>
<p>所以可以枚举 $a_1=1\dots9$ 并找到第一个合法的（这样字典序最小）即可。</p>
<h2 id="code-3">Code</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">200050</span><span class="op">;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> C<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> get<span class="op">(</span><span class="dt">int</span> t<span class="op">,</span> <span class="dt">char</span> <span class="op">*&amp;</span>s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(!*</span>s<span class="op">)</span> <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> x <span class="op">=</span> <span class="op">*</span>s <span class="op">-</span> <span class="ch">'0'</span><span class="op">;</span> <span class="op">++</span>s<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>x <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>x <span class="op">&gt;=</span> t<span class="op">)</span> <span class="cf">return</span> x <span class="op">%</span> t <span class="op">==</span> <span class="dv">0</span> <span class="op">?</span> x <span class="op">/</span> t <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">*</span>s <span class="op">-</span> <span class="ch">'0'</span><span class="op">;</span> <span class="op">++</span>s<span class="op">;</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">%</span> t <span class="op">==</span> <span class="dv">0</span> <span class="op">?</span> x <span class="op">/</span> t <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">,</span> A<span class="op">[</span>N<span class="op">],</span> B<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> Check<span class="op">(</span><span class="dt">int</span> a0<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  A<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> a0<span class="op">;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">char</span> <span class="op">*</span>s <span class="op">=</span> C<span class="op">;</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> m<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">((</span>B<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> get<span class="op">(</span>a0<span class="op">,</span> s<span class="op">))</span> <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">((</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> get<span class="op">(</span>B<span class="op">[</span><span class="dv">0</span><span class="op">],</span> s<span class="op">))</span> <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;</span> m<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>      <span class="dt">int</span> k <span class="op">=</span> A<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> B<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>k <span class="op">&lt;</span> <span class="dv">10</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>k <span class="op">+</span> <span class="ch">'0'</span> <span class="op">!=</span> <span class="op">*</span>s<span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">++</span>s<span class="op">;</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>k <span class="op">/</span> <span class="dv">10</span> <span class="op">+</span> <span class="ch">'0'</span> <span class="op">!=</span> <span class="op">*</span>s<span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">++</span>s<span class="op">;</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>k <span class="op">%</span> <span class="dv">10</span> <span class="op">+</span> <span class="ch">'0'</span> <span class="op">!=</span> <span class="op">*</span>s<span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">++</span>s<span class="op">;</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(*</span>s<span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> Work<span class="op">()</span> <span class="op">{</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d%s</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">,</span> <span class="op">&amp;</span>m<span class="op">,</span> C<span class="op">);</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="cf">if</span> <span class="op">(</span>Check<span class="op">(</span>i<span class="op">))</span> <span class="op">{</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span> putchar<span class="op">(</span>A<span class="op">[</span>j<span class="op">]</span> <span class="op">+</span> <span class="ch">'0'</span><span class="op">);</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    putchar<span class="op">(</span><span class="ch">' '</span><span class="op">);</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> m<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span> putchar<span class="op">(</span>B<span class="op">[</span>j<span class="op">]</span> <span class="op">+</span> <span class="ch">'0'</span><span class="op">);</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    putchar<span class="op">(</span><span class="ch">'</span><span class="sc">\n</span><span class="ch">'</span><span class="op">);</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span><span class="op">;</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>  puts<span class="op">(</span><span class="st">&quot;Impossible&quot;</span><span class="op">);</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> T<span class="op">;</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>T<span class="op">);</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>T<span class="op">--)</span> Work<span class="op">();</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="e-plants-vs.-zombies">[E] Plants vs. Zombies</h1>
<h2 id="description-4">Description</h2>
<p>直线上有 $n$ 个植物，第 $i$ 棵植物坐标为 $i$，浇一次水会长 $a_i$ 高。</p>
<p>你最开始在 $0$ 点，执行 $m$ 次操作。每次操作必须往左或右走一步并给走到的那棵植物（如果有）浇一次水。</p>
<p>最大化 $m$ 次操作后最矮的植物的高度。</p>
<p>$n\leqslant10^5,m\leqslant10^{12},\sum b\leqslant10^6$。2s/64MB</p>
<h2 id="solution-4">Solution</h2>
<p>先二分一个高度并求出每个位置至少浇水多少次。</p>
<p>首先我们证明，每种结尾在 $n$ 或者 $n-1$ 的方案都能换成（步数不变，每棵植物浇水次数也不变）</p>
<p>$$
1\to2\to1\to\dots\to2\to3\to2\to\dots\to3\to4\to\dots\to n-1\to n\to n-1
$$</p>
<p>的形式（如果停在 $n$ ，那最后就少走一步 $n-1\to n$），即“左右横跳”（雾</p>
<p>这个结论是显然的：既然从 $1$ 走到了 $n$ 或 $n-1$ 那么把走过的（有向）边拿出来就是一条欧拉路。不停地贪心“若可以往左走就往左走，否则往右走”一定能走成刚才那种形式。</p>
<p>接下来的结论是：任何方案都可以换成（同上）从 $n$ 或 $n-1$ 结尾的方案，从而换成上面那种样子。</p>
<p>如果最后停在了 $i$ 而 $i&lt;n-1$ ，那么由于它一定到过 $n$，所以存在两步是 $i+2\to i+1$ 和 $i+1\to i$ 。</p>
<p>把 $i+2\to i+1$ 这一步换成 $i\to i+1$（同时交换一下走顺序），显然这还可以构成欧拉路，并且终点变成了 $i+2$。</p>
<p>重复这个步骤可以让我们最后停在 $n$ 或者 $n-1$，且按上面那种走法走。</p>
<p>那么贪心一下就可以了（每次如果左边的没浇水就走到左边，否则走到右边）。</p>
<h2 id="code-4">Code</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> LL<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">100050</span><span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>LL m<span class="op">,</span> A<span class="op">[</span>N<span class="op">],</span> need<span class="op">[</span>N<span class="op">],</span> b<span class="op">[</span>N<span class="op">],</span> S<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> Check<span class="op">(</span>LL x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">((</span>need<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> x <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> A<span class="op">[</span>i<span class="op">])</span> <span class="op">&gt;</span> m<span class="op">)</span> <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  b<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> S<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> b<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="bu">std::</span>max<span class="op">(</span>need<span class="op">[</span>i<span class="op">]</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">-</span> b<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">],</span> <span class="dv">0</span><span class="bu">LL</span><span class="op">);</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> S<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> b<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> S<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">((</span>S<span class="op">[</span>n <span class="op">-</span> <span class="dv">2</span><span class="op">]</span> <span class="op">+</span> need<span class="op">[</span>n<span class="op">]</span> <span class="op">+</span> <span class="bu">std::</span>max<span class="op">(</span>need<span class="op">[</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">-</span> b<span class="op">[</span>n <span class="op">-</span> <span class="dv">2</span><span class="op">]</span> <span class="op">-</span> need<span class="op">[</span>n<span class="op">],</span> <span class="dv">0</span><span class="bu">LL</span><span class="op">))</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> n <span class="op">-</span> <span class="dv">1</span> <span class="op">&lt;=</span> m<span class="op">)</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">((</span>S<span class="op">[</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> <span class="bu">std::</span>max<span class="op">(</span>need<span class="op">[</span>n<span class="op">]</span> <span class="op">-</span> <span class="dv">1</span> <span class="op">-</span> b<span class="op">[</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">],</span> <span class="dv">0</span><span class="bu">LL</span><span class="op">))</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> n <span class="op">&lt;=</span> m<span class="op">)</span> <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> T<span class="op">;</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>T<span class="op">);</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>T<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%lld</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">,</span> <span class="op">&amp;</span>m<span class="op">);</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    LL l <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> r <span class="op">=</span> <span class="dv">1000000000000000000</span><span class="bu">LL</span><span class="op">;</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>l <span class="op">&lt;</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>      LL mid <span class="op">=</span> <span class="op">(</span>l <span class="op">+</span> r <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>Check<span class="op">(</span>mid<span class="op">))</span> l <span class="op">=</span> mid<span class="op">;</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> r <span class="op">=</span> mid <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> l<span class="op">);</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="f-tournament">[F] Tournament</h1>
<h2 id="description-5">Description</h2>
<p>有 $n$ 个骑士进行 $k$ 轮比赛。每轮比赛中每个骑士都要与另一名骑士对决，并且有两个条件：</p>
<ul>
<li>两名相同骑士只能对决一次。</li>
<li>如果在第 $i$ 轮中 <code>a</code> 与 <code>b</code> 对决，<code>c</code> 与 <code>d</code> 对决，而在第 $j$ 轮中 <code>a</code> 与 <code>c</code> 对决，那么在第 $j$ 轮中 <code>b</code> 必须与 <code>d</code> 对决。</li>
</ul>
<p>问有没有合法方案。如果有，输出字典序最小的方案。</p>
<p>$n,k\leqslant1000,\sum n,\sum k\leqslant5000$。1s/64MB</p>
<h2 id="solution-5">Solution</h2>
<p>可以构造对决至多 $2^t-1$ 场的方案，其中 $2^t\mid n, 2^{t+1}\not\mid n$。</p>
<p>构造方式很简单：第 $j$ 轮 $i$ 匹配 $i{,\rm xor,}j$，其中 $0\leqslant i&lt;n,1\leqslant j\leqslant k$。容易验证这是所有 $k\leqslant2^t-1$ 的字典序最小的方案（实际上相当于贪心构造）。</p>
<p>所以我们现在只需要做的事情是：证明确实最多只能对决 $2^t-1$ 场。</p>
<p>首先我们证明：$k$ 轮过后，如果两个骑士对决过就连一条边的话，得到的图里每个连通块大小都是 $2$ 的幂。</p>
<p>可以归纳证明：$k=0$ 是显然的（连通块大小都是 $2^0=1$）；假设前 $k-1$ 轮之后每个连通块大小都是 $2$ 的幂。</p>
<p>我们注意到，如果我确定了第 $k$ 轮某一个人的对手，那么可以用题面中第二条规则确定他所在连通块（前 $k-1$ 轮构成的图中的连通块，下同）所有人的对手；</p>
<p>并且如果是 <code>a</code> 和 <code>b</code> 对决的话，那么所有 <code>a</code> 连通块里的人都会与 <code>b</code> 连通块里的人对决，从而这两个连通块里的人一样多。</p>
<p>那么如果 <code>a</code> 和 <code>b</code> 对决，而它们本来就在一个连通块，之后还会在同一个连通块，于是根据归纳假设，这个连通块的大小还是 $2$ 的幂；</p>
<p>否则，<code>a</code> 和 <code>b</code> 不在一个连通块，但是他们所在的连通块大小相等。这两个连通块会合并成一个，从而变成了原来的两倍，还是 $2$ 的幂。</p>
<p>于是我们证明了结论。而如果对决了 $2^t$ 场，每个连通块大小必定大于 $2^t$，而又是 $2$ 的幂，从而是 $2^{t+1}$ 的倍数，与 $2^{t+1}\not\mid n$ 不符。</p>
<p>所以最多只能对决 $2^t-1$ 场。</p>
<h2 id="code-5">Code</h2>
<p>注意要求输出时从 1 开始编号。</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> T<span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>T<span class="op">);</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>T<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">,</span> k<span class="op">;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">,</span> <span class="op">&amp;</span>k<span class="op">);</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>k <span class="op">&gt;=</span> <span class="op">(</span>n <span class="op">&amp;</span> <span class="op">-</span>n<span class="op">))</span> puts<span class="op">(</span><span class="st">&quot;Impossible&quot;</span><span class="op">);</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> k<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>          printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%c</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">(</span>j <span class="op">^</span> i<span class="op">)</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="st">&quot; </span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">[</span>j <span class="op">==</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">]);</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="g-repair-the-artwork">[G] Repair the Artwork</h1>
<h2 id="description-6">Description</h2>
<p>给定一个长为 $n$ 的仅包含 0,1,2 的串，要求你用 $m$ 个区间覆盖掉所有的 $2$ 但不覆盖任何一个 $1$。问方案数。</p>
<p>区间有顺序，答案 $\bmod 10^9+7$。</p>
<p>$n\leqslant100,m\leqslant10^9,T\leqslant1000$，且 $n&gt;50$ 的不超过 $50$ 组。5s/64MB</p>
<h2 id="solution-6">Solution</h2>
<p>显然可以容斥：枚举哪些 $2$ 不被覆盖，若剩下的区间数是 $k$，则就把 $k^m$ 乘以 $1$ 或 $-1$ 加到答案里去。</p>
<p>那么可以用 dp 加速容斥：令 $f_{i,j}$ 表示若 $i$ 一定不被覆盖（$a_i=1,2$），则 $1\dots i$ 这段中，剩下的区间数是 $j$ 的方案对应的 $\pm1$ 的和是多少。</p>
<p>（换句话说就是，枚举 $1$ 到 $i$ 所有的 $2$ 里哪些不填，如果有 $t$ 个不填，而剩下的区间有 $k$ 个，那么 $f_{i,k}+=(-1)^t$）</p>
<p>dp 转移只需要枚举上一个必定不填的位置，可能是上一个 1 ，或者是当前位置与上一个 1 之间的所有 2。</p>
<p>为了方便可以在数列两头加上两个 1。</p>
<p>这样复杂度是 $O(n^4)$ （因为 $i=1\dots n,j=1\dots\frac{i(i+1)}2$）。但是仔细算一算转移总复杂度是 $\sum_{i=1}^n(n-i)\frac{i(i+1)}2\approx\frac{n^4}{12}$，还是能过的。</p>
<h2 id="code-6">Code</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> LL<span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">105</span><span class="op">;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> mod <span class="op">=</span> <span class="dv">1000000007</span><span class="op">;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">,</span> A<span class="op">[</span>N<span class="op">],</span> f<span class="op">[</span>N<span class="op">][</span>N <span class="op">*</span> N<span class="op">],</span> nxt<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>LL pow_mod<span class="op">(</span>LL x<span class="op">,</span> <span class="dt">int</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  LL ans <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>x <span class="op">%=</span> mod<span class="op">;</span> p<span class="op">;</span> p <span class="op">&gt;&gt;=</span> <span class="dv">1</span><span class="op">,</span> x <span class="op">=</span> x <span class="op">*</span> x <span class="op">%</span> mod<span class="op">)</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>p <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> ans <span class="op">=</span> ans <span class="op">*</span> x <span class="op">%</span> mod<span class="op">;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> Work<span class="op">()</span> <span class="op">{</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">,</span> <span class="op">&amp;</span>m<span class="op">);</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> l <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>A<span class="op">[</span>i<span class="op">])</span> l <span class="op">=</span> nxt<span class="op">[</span>l<span class="op">]</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  A<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> A<span class="op">[</span>nxt<span class="op">[</span>l<span class="op">]</span> <span class="op">=</span> <span class="op">++</span>n<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;=</span> i <span class="op">*</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span> <span class="op">++</span>j<span class="op">)</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>      f<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  nxt<span class="op">[</span>n<span class="op">]</span> <span class="op">=</span> n <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  f<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">=</span> nxt<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;=</span> i <span class="op">*</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span> <span class="op">++</span>j<span class="op">)</span> <span class="cf">if</span> <span class="op">(</span>f<span class="op">[</span>i<span class="op">][</span>j<span class="op">])</span> <span class="op">{</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>A<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> f<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">*=</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> nxt<span class="op">[</span>i<span class="op">];</span> k <span class="op">&lt;=</span> n<span class="op">;</span> k <span class="op">=</span> nxt<span class="op">[</span>k<span class="op">])</span> <span class="op">{</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> t <span class="op">=</span> k <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">(</span>f<span class="op">[</span>k<span class="op">][</span>j <span class="op">+</span> t <span class="op">*</span> <span class="op">(</span>t <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">]</span> <span class="op">+=</span> f<span class="op">[</span>i<span class="op">][</span>j<span class="op">])</span> <span class="op">%=</span> mod<span class="op">;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>A<span class="op">[</span>k<span class="op">]</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> n <span class="op">*</span> <span class="op">(</span>n <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span> f<span class="op">[</span>n<span class="op">][</span>i<span class="op">]</span> <span class="op">*</span> pow_mod<span class="op">(</span>i<span class="op">,</span> m<span class="op">))</span> <span class="op">%</span> mod<span class="op">;</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>  printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">(</span>ans <span class="op">+</span> mod<span class="op">)</span> <span class="op">%</span> mod<span class="op">);</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> T<span class="op">;</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>T<span class="op">);</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>T<span class="op">--)</span> Work<span class="op">();</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="i-soldier-game">[I] Soldier Game</h1>
<h2 id="description-7">Description</h2>
<p>$n$ 名士兵排成一排，第 $i$ 名士兵的能力值是 $a_i$。现在要把他们划成很多队伍，每支队伍要么是一个人，要么是连续的两个人。</p>
<p>一个人的队伍能力值就是这个人的能力值，两个人的队伍的能力值是他们两个能力值的和。</p>
<p>最小化队伍能力值的极差。</p>
<p>$n\leqslant10^5,\sum n\leqslant10^6$。2s/64MB</p>
<h2 id="solution-7">Solution</h2>
<p>可能的队伍显然只有 $2n-1$ 种。我们把队伍处理出来按能力值排序，那么只需要双指针扫一遍，同时用数据结构维护双指针之间的这些队伍能不能拼成整个 $1$ 到 $n$ 的区间。</p>
<p>由于队伍只可能是一个人或者相邻两个人，我们可以用线段树维护每个区间：</p>
<ul>
<li>能不能被目前可行的队伍拼出来；</li>
<li>去掉最左边一个人（他可能和更左边的组队）后能不能被拼出来；</li>
<li>去掉最右边的一个人之后能不能被拼出来；</li>
<li>两头的人都去掉之后能不能被拼出来。</li>
</ul>
<p>合并的时候考虑要不要把 $mid$ 和 $mid+1$ 组成一队即可。</p>
<h2 id="code-7">Code</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> LL<span class="op">;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">100050</span><span class="op">;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Msg <span class="op">{</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bool</span> f<span class="op">[</span><span class="dv">2</span><span class="op">][</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  Msg<span class="op">()</span> <span class="op">{}</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  Msg<span class="op">(</span><span class="dt">bool</span> a<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    f<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    f<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> f<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    f<span class="op">[</span><span class="dv">1</span><span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="kw">friend</span> Msg Merge<span class="op">(</span><span class="at">const</span> Msg <span class="op">&amp;</span>l<span class="op">,</span> <span class="at">const</span> Msg <span class="op">&amp;</span>r<span class="op">,</span> <span class="dt">bool</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    Msg ans<span class="op">;</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">2</span><span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">2</span><span class="op">;</span> <span class="op">++</span>j<span class="op">)</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        ans<span class="op">.</span>f<span class="op">[</span>i<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>l<span class="op">.</span>f<span class="op">[</span>i<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">&amp;&amp;</span> r<span class="op">.</span>f<span class="op">[</span><span class="dv">0</span><span class="op">][</span>j<span class="op">])</span> <span class="op">||</span> <span class="op">(</span>l<span class="op">.</span>f<span class="op">[</span>i<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">&amp;&amp;</span> r<span class="op">.</span>f<span class="op">[</span><span class="dv">1</span><span class="op">][</span>j<span class="op">]</span> <span class="op">&amp;&amp;</span> b<span class="op">);</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ans<span class="op">;</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> msgv<span class="op">[</span>N <span class="op">*</span> <span class="dv">4</span><span class="op">];</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> A<span class="op">[</span>N<span class="op">],</span> B<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="kw">inline</span> <span class="dt">void</span> upd<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>l <span class="op">==</span> r<span class="op">)</span> msgv<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> Msg<span class="op">(</span>A<span class="op">[</span>l<span class="op">]);</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>l <span class="op">+</span> r<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    msgv<span class="op">[</span>o<span class="op">]</span> <span class="op">=</span> Merge<span class="op">(</span>msgv<span class="op">[</span>o <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">],</span> msgv<span class="op">[</span>o <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">],</span> B<span class="op">[</span>mid<span class="op">]);</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> Build<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>l <span class="op">==</span> r<span class="op">)</span> A<span class="op">[</span>l<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>l <span class="op">+</span> r<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    B<span class="op">[</span>mid<span class="op">]</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    Build<span class="op">(</span>o <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> mid<span class="op">);</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    Build<span class="op">(</span>o <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> r<span class="op">);</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>  upd<span class="op">(</span>o<span class="op">,</span> l<span class="op">,</span> r<span class="op">);</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> ModifyA<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> x<span class="op">,</span> <span class="dt">bool</span> a<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>l <span class="op">&gt;</span> x <span class="op">||</span> r <span class="op">&lt;</span> x<span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>l <span class="op">==</span> r<span class="op">)</span> A<span class="op">[</span>l<span class="op">]</span> <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>l <span class="op">+</span> r<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>    ModifyA<span class="op">(</span>o <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> mid<span class="op">,</span> x<span class="op">,</span> a<span class="op">);</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>    ModifyA<span class="op">(</span>o <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> a<span class="op">);</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>  upd<span class="op">(</span>o<span class="op">,</span> l<span class="op">,</span> r<span class="op">);</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> ModifyB<span class="op">(</span><span class="dt">int</span> o<span class="op">,</span> <span class="dt">int</span> l<span class="op">,</span> <span class="dt">int</span> r<span class="op">,</span> <span class="dt">int</span> x<span class="op">,</span> <span class="dt">bool</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>l <span class="op">&gt;</span> x <span class="op">||</span> r <span class="op">&lt;=</span> x<span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>l <span class="op">+</span> r<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>  ModifyB<span class="op">(</span>o <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">,</span> l<span class="op">,</span> mid<span class="op">,</span> x<span class="op">,</span> b<span class="op">);</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>  ModifyB<span class="op">(</span>o <span class="op">&lt;&lt;</span> <span class="dv">1</span> <span class="op">|</span> <span class="dv">1</span><span class="op">,</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> r<span class="op">,</span> x<span class="op">,</span> b<span class="op">);</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>mid <span class="op">==</span> x<span class="op">)</span> B<span class="op">[</span>mid<span class="op">]</span> <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>  upd<span class="op">(</span>o<span class="op">,</span> l<span class="op">,</span> r<span class="op">);</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> V<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Team <span class="op">{</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> ty<span class="op">,</span> i<span class="op">,</span> v<span class="op">;</span> <span class="co">// 0 : A, 1 : B</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>  Team<span class="op">()</span> <span class="op">{}</span></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>  Team<span class="op">(</span><span class="dt">int</span> ty<span class="op">,</span> <span class="dt">int</span> i<span class="op">)</span> <span class="op">:</span> ty<span class="op">(</span>ty<span class="op">),</span> i<span class="op">(</span>i<span class="op">)</span> <span class="op">{</span> v <span class="op">=</span> V<span class="op">[</span>i<span class="op">]</span> <span class="op">+</span> ty <span class="op">*</span> V<span class="op">[</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">];</span> <span class="op">}</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>  <span class="dt">bool</span> <span class="kw">operator</span><span class="op">&lt;(</span><span class="at">const</span> Team <span class="op">&amp;</span>r<span class="op">)</span> <span class="at">const</span> <span class="op">{</span> <span class="cf">return</span> v <span class="op">&lt;</span> r<span class="op">.</span>v<span class="op">;</span> <span class="op">}</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> T<span class="op">[</span>N <span class="op">*</span> <span class="dv">2</span><span class="op">];</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> Work<span class="op">()</span> <span class="op">{</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">);</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>V<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> m <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> T<span class="op">[</span>m<span class="op">++]</span> <span class="op">=</span> Team<span class="op">(</span><span class="dv">0</span><span class="op">,</span> i<span class="op">);</span></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> T<span class="op">[</span>m<span class="op">++]</span> <span class="op">=</span> Team<span class="op">(</span><span class="dv">1</span><span class="op">,</span> i<span class="op">);</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>  Build<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>  <span class="bu">std::</span>sort<span class="op">(</span>T<span class="op">,</span> T <span class="op">+</span> m<span class="op">);</span></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> ans <span class="op">=</span> <span class="bn">0x7fffffff</span><span class="op">;</span></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> m<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(!</span>msgv<span class="op">[</span><span class="dv">1</span><span class="op">].</span>f<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">&amp;&amp;</span> j <span class="op">&lt;</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>      <span class="op">(</span>T<span class="op">[</span>j<span class="op">].</span>ty <span class="op">?</span> ModifyB <span class="op">:</span> ModifyA<span class="op">)(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> T<span class="op">[</span>j<span class="op">].</span>i<span class="op">,</span> <span class="kw">true</span><span class="op">);</span></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>      <span class="op">++</span>j<span class="op">;</span></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>msgv<span class="op">[</span><span class="dv">1</span><span class="op">].</span>f<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">])</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">((</span>LL<span class="op">)</span>T<span class="op">[</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>v <span class="op">-</span> T<span class="op">[</span>i<span class="op">].</span>v <span class="op">&lt;</span> ans<span class="op">)</span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>      ans <span class="op">=</span> T<span class="op">[</span>j <span class="op">-</span> <span class="dv">1</span><span class="op">].</span>v <span class="op">-</span> T<span class="op">[</span>i<span class="op">].</span>v<span class="op">;</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>    <span class="op">(</span>T<span class="op">[</span>i<span class="op">].</span>ty <span class="op">?</span> ModifyB <span class="op">:</span> ModifyA<span class="op">)(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> n<span class="op">,</span> T<span class="op">[</span>i<span class="op">].</span>i<span class="op">,</span> <span class="kw">false</span><span class="op">);</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>  printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> ans<span class="op">);</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> T<span class="op">;</span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>T<span class="op">);</span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>T<span class="op">--)</span> Work<span class="op">();</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="j-books">[J] Books</h1>
<h2 id="description-8">Description</h2>
<p>商店里有 $n$ 本书，第 $i$ 本书的价格是 $a_i$。</p>
<p>一个人拿着钱来到了商店，从 $1$ 到 $n$ 依次看过所有 $n$ 本书，每次如果自己还够买下当前的书就买下来。</p>
<p>已知他最后买了恰好 $m$ 本书，问他开始最多持有多少钱（钱是整数）。</p>
<p>无解输出 <code>Impossible</code>，答案无上界输出 <code>Richman</code>。</p>
<p>$0\leqslant m\leqslant n\leqslant10^5,\sum n\leqslant10^6,0\leqslant a_i\leqslant10^9$。1s/64MB</p>
<h2 id="solution-8">Solution</h2>
<p>所有 $a_i=0$ 的书他会无条件买下来。把这些 $a_i$ 都去掉，$n,m$ 都减去 $0$ 的个数。剩下的 $a_i&gt;0$。</p>
<p>那么结论是他持有钱最多的时候会买下前 $m$ 本书，并且买完前 $m$ 本书之后剩下的钱不够买任何一本书（但是再加 1 就够再买一本）。</p>
<p>如果他最优解中买的不是前 $m$ 本书，那么我可以让他继续多拿钱直到从前 $m$ 本书里再买下一本。这时候他刚刚多买下一本，因此这本后面的都没有买。</p>
<p>显然我们可以继续让他多拿钱直到他买了 $m$ 本为止。这说明刚才那个解肯定不是最优解。</p>
<p>因此最优解中他一定买下了前 $m$ 本书，剩下的钱数只需要在后面的书的价格里取 $\min$ 再减一即可。</p>
<p>如果 $m=n$ 输出 <code>Richman</code>，如果 $m&lt;0$ （意味着最开始 $a_i=0$ 的书多于 $m$ 本）输出 <code>Impossible</code>。</p>
<h2 id="code-8">Code</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> LL<span class="op">;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">100050</span><span class="op">;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">,</span> A<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> T<span class="op">;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>T<span class="op">);</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>T<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">,</span> <span class="op">&amp;</span>m<span class="op">);</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>      scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>A<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(!</span>A<span class="op">[</span>i<span class="op">])</span> <span class="op">--</span>n<span class="op">,</span> <span class="op">--</span>m<span class="op">,</span> <span class="op">--</span>i<span class="op">;</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>m <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> puts<span class="op">(</span><span class="st">&quot;Impossible&quot;</span><span class="op">);</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> m<span class="op">)</span> puts<span class="op">(</span><span class="st">&quot;Richman&quot;</span><span class="op">);</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>      LL S <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>      <span class="dt">int</span> mn <span class="op">=</span> <span class="bn">0x7fffffff</span><span class="op">;</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> m<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> S <span class="op">+=</span> A<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> m<span class="op">;</span> j <span class="op">&lt;</span> n<span class="op">;</span> <span class="op">++</span>j<span class="op">)</span> mn <span class="op">=</span> <span class="bu">std::</span>min<span class="op">(</span>mn<span class="op">,</span> A<span class="op">[</span>j<span class="op">]);</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>      printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> S <span class="op">+</span> mn <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="l-sub-cycle-graph">[L] Sub-cycle Graph</h1>
<h2 id="description-9">Description</h2>
<p>$n$ 个点 $m$ 条边的带标号无向图中有多少图是某个 $n$ 个点的环的子图。答案对 $10^9+7$ 取模。</p>
<p>$3\leqslant n\leqslant10^5,m\leqslant\frac{n(n-1)}2,\sum n\leqslant3\times10^7,T\approx2\times10^4$。2s/64MB</p>
<h2 id="solution-9">Solution</h2>
<p>$n&lt;m$ 时答案是 $0$，$n=m$ 时答案是 $\frac{(n-1)!}2$。下面假设 $n&gt;m$。</p>
<p>显然这个图的每个连通块都是一条链。我们先把链看成有顺序的，或者说给链标个号。因为链一共有 $n-m$ 条，最后的答案要除以 $(n-m)!$。</p>
<p>如果一个链有 $i$ 个点（已知有哪 $i$ 个点）那么方案数就是 $\begin{cases}1&amp;i=1\\frac{i!}2&amp;i&gt;1\end{cases}$，其指数型生成函数是 $\frac x2\left(1+\frac1{1-x}\right)$。</p>
<p>所以 $n-m$ 条链 $n$ 个点方案数就是</p>
<p>$$
\begin{aligned}
&amp;\quad \frac{n!}{(n-m)!}[x^n]\left(\frac x2\left(1+\frac1{1-x}\right)\right)^{n-m}\
&amp;=\frac{n!}{(n-m)!2^{n-m}}[x^m]\left(1+\frac1{1-x}\right)^{n-m}\
&amp;=\frac{n!}{(n-m)!2^{n-m}}\sum_{i=0}^{n-m}\binom{n-m}i[x^m]\frac1{(1-x)^{n-m}}\
&amp;=\frac{n!}{(n-m)!2^{n-m}}\sum_{i=0}^{n-m}\binom{n-m}i\binom{m+i-1}m
\end{aligned}
$$</p>
<p>除以 $(n-m)!$ 即为答案。注意这里认为 $\binom{-1}0=1$，解决这个问题可以特判一下 $m=0$ 的情况。</p>
<p>如果你需要这个公式的组合意义的话这里给出一个诡异的组合意义：</p>
<p>如果我们把 $n$ 个点排成一个链并把它切成 $n-m$ 部分，我们得到了 $n-m$ 条“有向链”，而且每种方案都会被得到 $(n-m)!$ 次。</p>
<p>理想的情况下我们把这个方案直接除以 $2^{n-m}$ 就行了。但是问题在于：单个点的“有向链”也只有 1 种方案。</p>
<p>那么我们强制指定每个单个点的链的方向。</p>
<p>我们从所有 $n-m$ 条链中选出若干条（注意现在链是有顺序的），强行令这些链是单点链且是“向左”的，剩下的链随便安排，但是其中单点链是“向右”的。</p>
<p>（换一种说法，对于多于一个点的链，我们可以说如果它左端点比右端点标号大就是“向左”的，反之就是“向右”的，而单点链的方向如上规定，则每条链的每个方向都被算过了）</p>
<p>那么这样的方案数和就是每条链的方向都有两种的方案了。除以 $(n-m)!2^{n-m}$ 即可。</p>
<p>这样的式子是（其中 $\binom{n-m}i$ 是选出 $i$ 条向左的单点链的方案数，$\binom{n-i-1}m$ 是从剩下 $n-i$ 个点中形成 $n-m-i$ 条链的方案数）</p>
<p>$$
\frac{n!}{(n-m)!2^{n-m}}\sum_{i=0}^{n-m}\binom{n-m}i\binom{n-i-1}m
$$</p>
<p>把 $i$ 换成 $n-m-i$ 就得到了刚才的式子。</p>
<h2 id="code-9">Code</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">100050</span><span class="op">;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> mod <span class="op">=</span> <span class="dv">1000000007</span><span class="op">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> <span class="dt">long</span> <span class="dt">long</span> LL<span class="op">;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>LL fac<span class="op">[</span>N<span class="op">],</span> ifac<span class="op">[</span>N<span class="op">],</span> inv<span class="op">[</span>N<span class="op">],</span> pv2<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>LL C<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> m <span class="op">&gt;</span> n <span class="op">||</span> m <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">?</span> <span class="dv">0</span> <span class="op">:</span> fac<span class="op">[</span>n<span class="op">]</span> <span class="op">*</span> ifac<span class="op">[</span>m<span class="op">]</span> <span class="op">%</span> mod <span class="op">*</span> ifac<span class="op">[</span>n <span class="op">-</span> m<span class="op">]</span> <span class="op">%</span> mod<span class="op">;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  inv<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> inv<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="op">-(</span>mod <span class="op">/</span> i<span class="op">)</span> <span class="op">*</span> inv<span class="op">[</span>mod <span class="op">%</span> i<span class="op">]</span> <span class="op">%</span> mod<span class="op">;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  fac<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> ifac<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> pv2<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    fac<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> fac<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">*</span> i <span class="op">%</span> mod<span class="op">;</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    ifac<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> ifac<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">*</span> inv<span class="op">[</span>i<span class="op">]</span> <span class="op">%</span> mod<span class="op">;</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    pv2<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> pv2<span class="op">[</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">*</span> inv<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">%</span> mod<span class="op">;</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> T<span class="op">;</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>T<span class="op">);</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>T<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    LL m<span class="op">;</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%lld</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">,</span> <span class="op">&amp;</span>m<span class="op">);</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> m<span class="op">)</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">(</span>fac<span class="op">[</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">*</span> inv<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">%</span> mod <span class="op">+</span> mod<span class="op">)</span> <span class="op">%</span> mod<span class="op">);</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>m <span class="op">&gt;</span> n<span class="op">)</span> puts<span class="op">(</span><span class="st">&quot;0&quot;</span><span class="op">);</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>m <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> puts<span class="op">(</span><span class="st">&quot;1&quot;</span><span class="op">);</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>      LL ans <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n <span class="op">-</span> m<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>        ans <span class="op">=</span> <span class="op">(</span>ans <span class="op">+</span> C<span class="op">(</span>n <span class="op">-</span> m<span class="op">,</span> i<span class="op">)</span> <span class="op">*</span> C<span class="op">(</span>m <span class="op">+</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> m<span class="op">))</span> <span class="op">%</span> mod<span class="op">;</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>      ans <span class="op">=</span> ans <span class="op">*</span> fac<span class="op">[</span>n<span class="op">]</span> <span class="op">%</span> mod <span class="op">*</span> ifac<span class="op">[</span>n <span class="op">-</span> m<span class="op">]</span> <span class="op">%</span> mod <span class="op">*</span> pv2<span class="op">[</span>n <span class="op">-</span> m<span class="op">]</span> <span class="op">%</span> mod<span class="op">;</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>      printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%lld\n</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">(</span>ans <span class="op">+</span> mod<span class="op">)</span> <span class="op">%</span> mod<span class="op">);</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="m-function-and-function">[M] Function and Function</h1>
<h2 id="description-10">Description</h2>
<p>定义 $f(x)$ 为 $x$ 的十进制阿拉伯数字写出来的闭合区域个数。</p>
<p>或者说，</p>
<p>$f(0)=f(4)=f(6)=f(9)=1,f(1)=f(2)=f(3)=f(5)=f(7)=0,f(8)=2$，</p>
<p>而其他情况下 $f(x)$ 等于其每一位数字 $f$ 的和。令</p>
<p>$$
g^k(x)=\begin{cases}x&amp;k=0\f(g^{k-1}(x))&amp;k&gt;0\end{cases}
$$</p>
<p>给定 $k,x$，求 $g^k(x)$。1s/64MB</p>
<h2 id="solution-10">Solution</h2>
<p>由于 $f(x)=O(\log x)$，所以 $O(\log^*(x))$ 次之后就会变成 $0$。这时候判一下 $k$ 的奇偶性即可。</p>
<h2 id="code-10">Code</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstdio&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> A<span class="op">[]</span> <span class="op">=</span> <span class="op">{</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span> <span class="op">};</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> f<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> <span class="op">(</span>x <span class="op">&gt;=</span> <span class="dv">10</span> <span class="op">?</span> f<span class="op">(</span>x <span class="op">/</span> <span class="dv">10</span><span class="op">)</span> <span class="op">:</span> <span class="dv">0</span><span class="op">)</span> <span class="op">+</span> A<span class="op">[</span>x <span class="op">%</span> <span class="dv">10</span><span class="op">];</span> <span class="op">}</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> T<span class="op">;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>T<span class="op">);</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span>T<span class="op">--)</span> <span class="op">{</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">,</span> k<span class="op">;</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d%d</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>k<span class="op">);</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>x <span class="op">&amp;&amp;</span> k<span class="op">)</span> x <span class="op">=</span> f<span class="op">(</span>x<span class="op">),</span> <span class="op">--</span>k<span class="op">;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(!</span>k<span class="op">)</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> x<span class="op">);</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> k <span class="op">&amp;</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

        </main>

        <footer>
            ♥ 由
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
            生成！

            © 遵循
            <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
                CC-BY 4.0
            </a>
            知识共享协议.
        </footer>
    </body>
</html>
